MEXT = md
SRC  = $(wildcard *.$(MEXT))

## x.pdf/x.html/x.docx depends on x.md
PDFS = $(SRC:.md=.pdf)
HTML = $(SRC:.md=.html)
DOCX = $(SRC:.md=.docx)

## Rules - make all, make pdf, make html, make docx
all:    $(PDFS) $(HTML) $(TEX) $(DOCX)
pdf:    clean $(PDFS)
html:   clean $(HTML)
docx:   clean $(DOCX)

## make html. 
%.html: %.md
	pandoc -r markdown+simple_tables+table_captions+yaml_metadata_block \ 
	-w html -S -o $@ $<

## make pdf.
%.pdf:  %.md
	pandoc -r markdown+simple_tables+table_captions+yaml_metadata_block \ 
	--listings -s -S --latex-engine=pdflatex \ 
	--filter pandoc-crossref --filter pandoc-citeproc -o $@ $<

%.docx: %.md
	pandoc -r markdown+simple_tables+table_captions+yaml_metadata_block \ 
	-s -S --filter pandoc-crossref -o $@ $<

clean:
	rm -f *.html *.pdf *.tex *.aux *.log *.docx

.PHONY: clean	
